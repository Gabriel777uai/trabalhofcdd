<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/bootstrap.min.css">
    <link rel="shortcut icon" href="../assets/img/favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="../assets/css/inicial.css">
    <title>Cadastrar Cliente</title>
</head>

<body>
    <span id="topo"></span>

    <!-- Header -->
    <div id="header">
        <button id="btnMobileToggle"><i class="bi bi-list"></i></button>
        <h1>Paínel de Controle</h1>
        <img src="../assets/img/estoque-logo.png" alt="logo-eia" width="50px" class="ms-4">
        <h4 style="text-align: end;">Olá, <span id="user"></span>!</h4>
    </div>

    <!-- Menu lateral -->
    <div class="menu-lateral" id="menuLateral">
        <div class="menu-header">
            <h3>Menu</h3>
        </div>
        <ul class="menu-opcoes">
            <li data-role="1"><a href="inicial.html"><i class="bi bi-house-fill"></i> Início</a></li>
            <li data-role="2"><a href="cadastroProdutos.html"><i class="bi bi-box-seam"></i> Cadastrar Produtos</a></li>
            <li data-role="5"><a href="cadastroUsuarios.html"><i class="bi bi-person-plus"></i> Cadastrar Usuários</a>
            </li>
            <li data-role="3"><a href="cadastroClientes.html" class="active"><i class="bi bi-people-fill"></i> Cadastrar
                    Clientes</a></li>
            <li data-role="1"><a href="vender.html"><i class="bi bi-cash-coin"></i> Vendas</a></li>
            <li data-role="3"><a href="relatorios.html"><i class="bi bi-graph-up"></i> Relatórios</a></li>
            <li data-role="1"><a href="configuracoes.html"><i class="bi bi-gear-fill"></i> Configurações</a></li>
            <li data-role="1"><a href="#" id="btnLogout"><i class="bi bi-box-arrow-right"></i> Sair</a></li>
        </ul>
    </div>

    <div class="overlay" id="overlay"></div>

    <!-- Conteúdo principal -->
    <main>
        <section class="search-section">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2>Cadastro de Clientes</h2>
                    <p class="text-muted mb-0">Preencha as informações abaixo para adicionar um novo cliente.</p>
                </div>
                <button class="btn btn-outline-primary" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasClientes" aria-controls="offcanvasClientes">
                    <i class="bi bi-list-ul"></i> Listar Clientes
                </button>
            </div>

            <form id="formCadastroCliente" class="p-4 border rounded bg-white shadow-sm">

                <!-- Tipo de Pessoa Toggle -->
                <div class="mb-4">
                    <label class="form-label fw-bold d-block">Tipo de Cliente</label>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="tipoPessoa" id="tipoFisica" value="fisica"
                            checked>
                        <label class="form-check-label" for="tipoFisica">Pessoa Física (CPF)</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="tipoPessoa" id="tipoJuridica"
                            value="juridica">
                        <label class="form-check-label" for="tipoJuridica">Pessoa Jurídica (CNPJ)</label>
                    </div>
                </div>

                <div class="row g-3">

                    <!-- CNPJ Field (Hidden by default) -->
                    <div class="col-md-6 d-none" id="divCnpj">
                        <label for="cnpj" class="form-label fw-bold">CNPJ</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="cnpj" placeholder="00.000.000/0000-00">
                            <button class="btn btn-primary" type="button" id="btnBuscarCnpj">
                                <i class="bi bi-search"></i> Buscar
                            </button>
                        </div>
                        <small class="text-muted">Busca automática de dados na Receita.</small>
                    </div>

                    <!-- CPF Field -->
                    <div class="col-md-6" id="divCpf">
                        <label for="cpf" class="form-label fw-bold">CPF</label>
                        <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00">
                    </div>

                    <!-- Fields that change label/visibility -->
                    <div class="col-md-6">
                        <label for="nome" class="form-label fw-bold" id="lblNome">Nome Completo</label>
                        <input type="text" class="form-control" id="nome" required>
                    </div>

                    <div class="col-md-6 d-none" id="divRazao">
                        <label for="razao" class="form-label fw-bold">Razão Social</label>
                        <input type="text" class="form-control" id="razao">
                    </div>

                    <!-- Contact Fields -->
                    <div class="col-md-6">
                        <label for="email" class="form-label fw-bold">E-mail</label>
                        <input type="email" class="form-control" id="email" placeholder="contato@exemplo.com">
                    </div>
                    <div class="col-md-6">
                        <label for="telefone" class="form-label fw-bold">Telefone / Celular</label>
                        <input type="tel" class="form-control" id="telefone" required>
                    </div>

                    <!-- Specific Fields -->
                    <div class="col-md-4" id="divNascimento">
                        <label for="dataNasc" class="form-label fw-bold">Data de Nascimento</label>
                        <input type="date" class="form-control" id="dataNasc">
                    </div>

                    <div class="col-md-8" id="divSeguimento">
                        <label for="seguimento" class="form-label fw-bold">Seguimento / Atividade</label>
                        <input type="text" class="form-control" id="seguimento" value="Comprador final">
                    </div>

                    <!-- Address Fields -->
                    <div class="col-md-6">
                        <label for="endereco" class="form-label fw-bold">Endereço (Rua, Av, etc)</label>
                        <input type="text" class="form-control" id="endereco" required>
                    </div>
                    <div class="col-md-2">
                        <label for="numeroEnd" class="form-label fw-bold">Número</label>
                        <input type="text" class="form-control" id="numeroEnd" placeholder="S/N">
                    </div>
                    <div class="col-md-4">
                        <label for="bairro" class="form-label fw-bold">Bairro</label>
                        <input type="text" class="form-control" id="bairro">
                    </div>
                    <div class="col-md-6">
                        <label for="cidade" class="form-label fw-bold">Cidade</label>
                        <input type="text" class="form-control" id="cidade" required>
                    </div>
                    <div class="col-md-6">
                        <label for="estado" class="form-label fw-bold">Estado (UF)</label>
                        <input type="text" class="form-control" id="estado" maxlength="2" placeholder="Ex: SP" required>
                    </div>
                </div>

                <div class="mt-4 text-end">
                    <button type="reset" class="btn btn-secondary"><i class="bi bi-arrow-counterclockwise"></i>
                        Limpar</button>
                    <button type="submit" class="btn btn-primary"><i class="bi bi-save"></i> Cadastrar Cliente</button>
                </div>
            </form>
        </section>
    </main>

    <!-- Offcanvas Lista de Clientes -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasClientes" aria-labelledby="offcanvasClientesLabel"
        style="width: 400px;">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasClientesLabel">Clientes Cadastrados</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="mb-3">
                <label for="inputBuscaCliente" class="form-label">Pesquisar Cliente</label>
                <div class="input-group">
                    <input type="text" class="form-control" id="inputBuscaCliente" placeholder="Nome ou CPF/CNPJ">
                    <button class="btn btn-outline-secondary" type="button" id="btnBuscaCliente">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </div>

            <div id="listaClientesContainer" class="list-group list-group-flush border-top">
                <!-- Lista será preenchida via JS -->
                <div class="text-center p-3 text-muted">Carregando...</div>
            </div>
        </div>
    </div>

    <script> window.chtlConfig = { chatbotId: "4416448636" } </script>
    <script async data-id="4416448636" id="chtl-script" type="text/javascript"
        src="https://chatling.ai/js/embed.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../assets/vendor/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="../assets/vendor/jquery/jquery.js"></script>
    <!-- Import Map to resolve bare modules -->
    <script type="importmap">
    {
      "imports": {
        "jwt-decode": "https://cdn.jsdelivr.net/npm/jwt-decode@4.0.0/build/esm/index.js"
      }
    }
    </script>
    <script type="module" src="../assets/js/menu_roles.js"></script>
    <script src="../assets/js/auth.js"></script>
    <script src="../assets/js/cadastroClientes.js"></script>
    <script src="../assets/js/responsive.js"></script>
    <script src="../assets/js/logout.js"></script>
</body>

</html>